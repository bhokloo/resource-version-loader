{"version":3,"file":"resource-version-loader.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,wBAAyB,GAAIH,GACV,iBAAZC,QACdA,QAA+B,sBAAID,IAEnCD,EAA4B,sBAAIC,GACjC,CATD,CASGK,MAAM,I,mBCRT,IAAIC,EAAsB,CCA1BA,EAAwB,CAACL,EAASM,KACjC,IAAI,IAAIC,KAAOD,EACXD,EAAoBG,EAAEF,EAAYC,KAASF,EAAoBG,EAAER,EAASO,IAC5EE,OAAOC,eAAeV,EAASO,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDF,EAAwB,CAACQ,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFT,EAAyBL,IACH,oBAAXkB,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeV,EAASkB,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeV,EAAS,aAAc,CAAEoB,OAAO,GAAO,G,KCQ9D,SAASC,EAAqBC,EAAMC,GAClC,MAAMC,EAAUC,SAASC,cAAcJ,GACvCE,EAAiB,SAATF,EAAkB,MAAQ,QAAmB,SAATA,EAAkB,aAAe,SAC7EE,EAAiB,SAATF,EAAkB,OAAS,OAASC,EAC5CE,SAASE,KAAKC,YAAYJ,EAC5B,CAEA,SAASK,EAA6BC,EAAaC,GACjD,MAAO,GAAGD,OAAiBC,GAC7B,CAUAC,eAAeC,EAAwBC,EAAiBC,EAAgBC,EAAeC,EAAcC,GACnG,MAAMC,QAjCRP,eAAkCE,GAChC,IACE,MAAMM,QAAiBC,MAAMP,EAAiB,CAC5CQ,MAAO,aAGT,aADmBF,EAASG,QAChBZ,OACd,CAAE,MAAOa,GAEP,OADAC,QAAQD,MAAM,iCAAkCA,GACzC,IACT,CACF,CAsB8BE,CAAmBZ,GAE3CK,GAAiBA,IAAkBF,IACrCC,EAAmBC,GAZvB,SAAyBR,EAASI,EAAgBC,GAChD,MAAMW,EAAelB,EAA6BO,EAAeL,GAGjEV,EAAqB,OAFFQ,EAA6BM,EAAgBJ,IAGhEV,EAAqB,SAAU0B,EACjC,CAOIC,CAAgBT,EAAeJ,EAAgBC,GAEnD,C,8BAiBA,QAfA,SAA+Ba,GAC7B,MAAM,gBACJf,EAAe,eACfC,EAAc,cACdC,EAAa,aACbC,EAAY,mBACZC,GACEW,EAGJC,OAAOC,OAAS,WACdlB,EAAwBC,EAAiBC,EAAgBC,EAAeC,EAAcC,EACxF,CACF,E","sources":["webpack://ResourceVersionLoader/webpack/universalModuleDefinition","webpack://ResourceVersionLoader/webpack/bootstrap","webpack://ResourceVersionLoader/webpack/runtime/define property getters","webpack://ResourceVersionLoader/webpack/runtime/hasOwnProperty shorthand","webpack://ResourceVersionLoader/webpack/runtime/make namespace object","webpack://ResourceVersionLoader/./index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ResourceVersionLoader\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ResourceVersionLoader\"] = factory();\n\telse\n\t\troot[\"ResourceVersionLoader\"] = factory();\n})(this, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","async function FetchLatestVersion(versionEndpoint) {\r\n  try {\r\n    const response = await fetch(versionEndpoint, {\r\n      cache: 'no-store',\r\n    });\r\n    const data = await response.json();\r\n    return data.version;\r\n  } catch (error) {\r\n    console.error(\"Error fetching latest version:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction AppendResourceToHead(type, url) {\r\n  const element = document.createElement(type);\r\n  element[type === 'link' ? 'rel' : 'type'] = type === 'link' ? 'stylesheet' : 'module';\r\n  element[type === 'link' ? 'href' : 'src'] = url;\r\n  document.head.appendChild(element);\r\n}\r\n\r\nfunction LoadResourceWithCacheBusting(resourceUrl, version) {\r\n  return `${resourceUrl}?v=${version}`;\r\n}\r\n\r\nfunction UpdateResources(version, cssResourceUrl, jsResourceUrl) {\r\n  const newScriptSrc = LoadResourceWithCacheBusting(jsResourceUrl, version);\r\n  const newCssHref = LoadResourceWithCacheBusting(cssResourceUrl, version);\r\n\r\n  AppendResourceToHead('link', newCssHref);\r\n  AppendResourceToHead('script', newScriptSrc);\r\n}\r\n\r\nasync function UpdateResourcesIfNeeded(versionEndpoint, cssResourceUrl, jsResourceUrl, localVersion, updateLocalVersion) {\r\n  const latestVersion = await FetchLatestVersion(versionEndpoint);\r\n\r\n  if (latestVersion && latestVersion !== localVersion) {\r\n    updateLocalVersion(latestVersion);\r\n    UpdateResources(latestVersion, cssResourceUrl, jsResourceUrl);\r\n  }\r\n}\r\n\r\nfunction ResourceVersionLoader(options) {\r\n  const {\r\n    versionEndpoint,\r\n    cssResourceUrl,\r\n    jsResourceUrl,\r\n    localVersion,\r\n    updateLocalVersion,\r\n  } = options;\r\n\r\n  // Update resources when the page is loaded or refreshed\r\n  window.onload = function() {\r\n    UpdateResourcesIfNeeded(versionEndpoint, cssResourceUrl, jsResourceUrl, localVersion, updateLocalVersion);\r\n  };\r\n}\r\n\r\nexport default ResourceVersionLoader;\r\n"],"names":["root","factory","exports","module","define","amd","this","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","AppendResourceToHead","type","url","element","document","createElement","head","appendChild","LoadResourceWithCacheBusting","resourceUrl","version","async","UpdateResourcesIfNeeded","versionEndpoint","cssResourceUrl","jsResourceUrl","localVersion","updateLocalVersion","latestVersion","response","fetch","cache","json","error","console","FetchLatestVersion","newScriptSrc","UpdateResources","options","window","onload"],"sourceRoot":""}